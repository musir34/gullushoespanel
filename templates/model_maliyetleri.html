
{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4">Model Maliyetleri Tablosu</h2>
    
    <!-- Filtreleme Bölümü -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <form action="{{ url_for('get_products.model_maliyetleri') }}" method="GET" class="row g-3">
                <div class="col-md-4">
                    <label for="search" class="form-label">Model Kodu Ara:</label>
                    <input type="text" class="form-control" id="search" name="search" value="{{ search or '' }}" placeholder="Model kodu girin...">
                </div>
                <div class="col-md-3">
                    <label for="date_start" class="form-label">Başlangıç Tarihi:</label>
                    <input type="date" class="form-control" id="date_start" name="date_start" value="{{ date_start or '' }}">
                </div>
                <div class="col-md-3">
                    <label for="date_end" class="form-label">Bitiş Tarihi:</label>
                    <input type="date" class="form-control" id="date_end" name="date_end" value="{{ date_end or '' }}">
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100">Filtrele</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Model Tablosu -->
    <div class="card shadow">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-striped">
                    <thead class="table-dark">
                        <tr>
                            <th>Model Kodu</th>
                            <th>Toplam Satış Adedi</th>
                            <th>Toplam Ciro (TL)</th>
                            <th>Ortalama Satış Fiyatı</th>
                            <th>Maliyet</th>
                            <th>Kâr</th>
                            <th>İşlemler</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if model_data %}
                            {% for model in model_data %}
                                <tr>
                                    <td><strong>{{ model.product_main_id }}</strong></td>
                                    <td>{{ model.total_quantity }}</td>
                                    <td>{{ "%.2f"|format(model.total_amount) }} ₺</td>
                                    <td>{{ "%.2f"|format(model.average_price) }} ₺</td>
                                    <td>{{ "%.2f"|format(model.cost or 0) }} ₺</td>
                                    <td class="{% if model.profit > 0 %}text-success{% else %}text-danger{% endif %}">
                                        {{ "%.2f"|format(model.profit or 0) }} ₺
                                    </td>
                                    <td>
                                        <a href="{{ url_for('get_products.model_detay', model_id=model.product_main_id) }}" class="btn btn-sm btn-info">
                                            <i class="fas fa-eye"></i> Detay
                                        </a>
                                    </td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="7" class="text-center">Hiç model verisi bulunamadı.</td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
